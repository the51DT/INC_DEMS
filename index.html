<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>DEMS | path</title>
  <link type="text/css" rel="stylesheet" href="./assets/css/index.css" />
  <script src="./assets/js/jquery-3.7.1.slim.min.js"></script>
</head>

<body>
  <div id="guideWrap">
    <header>
      <!-- Guide Header -->
      <div id="guideHeader">
        <div>
          <h1>DEMS 퍼블 리스트</h1>
          <div class="total"></div>
        </div>
      </div>
      <!-- Navi Menu -->
      <div class="path-head">
        <div class="naviMenu"></div>
        <ul class="mark-wrap">
          <li><span class="icon-state"></span>대기</li>
          <li><span class="icon-state working"></span>작업중</li>
          <li><span class="icon-state retouch"></span>수정</li>
          <li><span class="icon-state comp"></span>완료</li>
        </ul>
      </div>
      <!-- // Navi Menu -->
    </header>
    <!-- Path List -->
    <div class="pathList">
      <!-- Path -->

      <div id="path-wrap">
        <table class="pathTbl">
          <caption>Path List</caption>
          <colgroup>
            <col width='6%' />
            <col width='8%' />
            <col width='8%' />
            <col width='8%' />
            <col width='8%' />
            <col width='15%' />
            <col width='7%' />
            <col width='3%' />
            <col width='17%' />
          </colgroup>
          <thead>
            <tr>
              <th scope="col">Depth 1</th>
              <th scope="col">Depth 2</th>
              <th scope="col">Depth 3</th>
              <th scope="col">Depth 4</th>
              <th scope="col">Depth 5</th>
              <th scope="col">URL</th>
              <th scope="col">Date</th>
              <th scope="col">State</th>
              <th scope="col">Notice</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      </div>
      <!-- // Path -->
    </div>
    <!-- // Path List -->
  </div>
</body>

<script>
  var path = [{
      dep1: '가이드',
      dep2: '',
      dep3: '',
      dep4: '',
      dep5: '',
      url: 'guide.html',
      date: '24.08.16',
      check: '<span class="icon-state comp"></span>',
      noti: ''
    }, {
      dep1: '로그인',
      dep2: '로그인',
      dep3: '',
      dep4: '',
      dep5: '',
      url: 'login_main.html',
      date: '24.08.19',
      check: '<span class="icon-state retouch"></span>',
      noti: '** 로고 이미지 필요 **'
    }, {
      dep1: '로그인',
      dep2: '인증번호 입력',
      dep3: '',
      dep4: '',
      dep5: '',
      url: 'login_certification.html',
      date: '24.08.19',
      check: '<span class="icon-state retouch"></span>',
      noti: '** 로고 이미지 필요 **'
    }, {
      dep1: '이메일',
      dep2: '메일 폼',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '마이페이지',
      dep2: '내 정보',
      dep3: '',
      dep4: '',
      dep5: '',
      url: 'mypage.html',
      date: '24.08.19',
      check: '<span class="icon-state comp"></span>',
      noti: ''
    }, {
      dep1: '시승 행사 관리',
      dep2: '진행/예정 행사',
      dep3: '행사 없는 케이스',
      dep4: '',
      dep5: '',
      url: 'event_nodata.html',
      date: '24.08.19',
      check: '<span class="icon-state comp"></span>',
      noti: ''
    }, {
      dep1: '시승 행사 관리',
      dep2: '',
      dep3: '리스트',
      dep4: '',
      dep5: '',
      url: 'event_list.html',
      date: '24.08.19',
      check: '<span class="icon-state retouch"></span>',
      noti: '** 행사 로고 이미지 필요 **'
    }, {
      dep1: '시승 행사 관리',
      dep2: '종료된 행사',
      dep3: '리스트',
      dep4: '',
      dep5: '',
      url: 'event_end.html',
      date: '24.08.19',
      check: '<span class="icon-state retouch"></span>',
      noti: '** 행사 로고 이미지 필요 **'
    }, {
      dep1: '시승 행사 관리',
      dep2: '',
      dep3: '행사리포트',
      dep4: '',
      dep5: '',
      url: 'event_report.html',
      date: '24.08.19',
      check: '<span class="icon-state retouch"></span>',
      noti: '** PDF 아이콘 필요 **'
    }, {
      dep1: '시승 행사 관리',
      dep2: '행사 등록',
      dep3: '일반사항',
      dep4: '',
      dep5: '',
      url: 'event_add_common.html',
      date: '24.08.19',
      check: '<span class="icon-state comp"></span>',
      noti: ''
    }, {
      dep1: '시승 행사 관리',
      dep2: '',
      dep3: '그룹설정',
      dep4: '',
      dep5: '',
      url: 'event_add_group.html',
      date: '24.08.19',
      check: '<span class="icon-state comp"></span>',
      noti: '<li>등록 완료 팝업</li><li>삭제 팝업(step1)</li><li>삭제 팝업(step2)</li>'
    }, {
      dep1: '시승 동의서 관리',
      dep2: '시승동의서 목록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: 'consent_list.html',
      date: '24.08.19',
      check: '<span class="icon-state retouch"></span>',
      noti: '<li>시승동의서 미리보기 팝업(동의서 이미지 노출 / 서명 기능)</li>** PDF 아이콘 / 동의서 이미지 필요 **'
    }, {
      dep1: '시승 동의서 관리',
      dep2: '시승동의서 등록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: 'consent_add.html',
      date: '24.08.19',
      check: '<span class="icon-state retouch"></span>',
      noti: '<li>텍스트에디터 기능</li>** 기능 개발에서 작업여부 확인 필요 **'
    }, {
      dep1: '관리자 계정 관리',
      dep2: '계정 목록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '관리자 계정 관리',
      dep2: '계정 등록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '관리자 계정 관리',
      dep2: '계정 관리자 정보',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '대쉬보드',
      dep2: '대쉬보드',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '시승자 관리',
      dep2: '시승자 명단',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: '<li>체크인 팝업(step1)</li><li>체크인 팝업(step2)</li><li>체크인 팝업(step2 / 미작성 시 동의서 팝업 노출)</li><li>체크인 팝업(step3)</li>'
    }, {
      dep1: '시승자 관리',
      dep2: '시승자 등록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '시승자 관리',
      dep2: '시승 동의서',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: '<li>동의서 팝업</li>'
    }, {
      dep1: '시승차량 관리',
      dep2: '차량 목록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '시승차량 관리',
      dep2: '차량 등록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '시승차량 관리',
      dep2: '운행 이력',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '시승차량 관리',
      dep2: '연번 관리',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '시승차량 이슈관리',
      dep2: '이슈 목록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: '<li>차량 이슈 상세 팝업</li>'
    }, {
      dep1: '시승차량 이슈관리',
      dep2: '이슈 등록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: '<li>이상 부위 체크 팝업</li>'
    }, {
      dep1: '운영 정보 공유',
      dep2: '코스정보 공유',
      dep3: '리스트',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '운영 정보 공유',
      dep2: '',
      dep3: '글쓰기',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '운영 정보 공유',
      dep2: '게시판 본문',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '운영 정보 공유',
      dep2: 'DEMS 매뉴얼',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '리포트',
      dep2: '행사리포트',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '초대장 관리',
      dep2: '초대장 목록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: '초대장 관리',
      dep2: '초대장 등록',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: 'STAFF 알림',
      dep2: '공지사항',
      dep3: '리스트',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: 'STAFF 알림',
      dep2: '',
      dep3: '글쓰기',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    }, {
      dep1: 'STAFF 알림',
      dep2: '행사 FEED',
      dep3: '',
      dep4: '',
      dep5: '',
      url: '',
      date: '',
      check: '',
      noti: ''
    },
  ];

  var _tablePath = "";

  var pathWrap = document.getElementById('path-wrap');
  var pathTbody = pathWrap.querySelector('tbody')
  path.forEach(function (e) {
    pathTbody.innerHTML += "<tr><th class='dep1'><p class='tit'>" + e.dep1 +
      "</p></th><td class='dep2'><p class='tit'>" + e.dep2 + "</p></td><td class='dep3'><p class='tit'>" + e
      .dep3 + "</p></td><td class='dep4'><p class='tit'>" + e.dep4 +
      "</p></td><td class='dep5'><p class='tit'>" + e.dep5 + "</p></td><td class='url'><span>" + e.url +
      "</span></td><td class='date'>" + e.date + "</td><td class='check'>" + e.check +
      "</td><td class='txt'><ul>" + e.noti + "</ul></td></tr>"
  });
  var hasPathObject = function ($elem) {
    return $elem.length > 0;
  };
  var pathApp = pathApp || {};

  pathApp.tableRowSpan = function () {
    $(".dep1").each(function () {
      var tempString = $(this).text();
      var dep1_rows = $(".dep1").filter(function () {
        return $(this).text() == tempString;
      });
      if (dep1_rows.length > 1) {
        dep1_rows.eq(0).attr("rowspan", dep1_rows.length);
        dep1_rows.not(":eq(0)").remove();
      }
    });
  };

  pathApp.setUrl = function () {
    var $url = pathApp.$body.find(".url span");
    $url.each(function () {
      var link = $(this).text(),
        str = "";
      if (link != null && link != "") {
        str +=
          '<a href="./html/' +
          link +
          '" target="_blank" rel="noopener">' +
          link +
          "</a>";
        $(this).empty().html(str);
      }
    });
  };

  pathApp.setDate = function () {
    var now = new Date();
    var year = now.getFullYear();
    var month = now.getMonth() + 1;
    var $date = pathApp.$body.find(".date");
    if (month < 10) {
      month = "0" + month;
    }
    var date = now.getDate();
    if (date < 10) {
      date = "0" + date;
    }
    $date.each(function () {
      var $date = $("> span", this),
        str = "";
      str += "<p>" + $date.filter(":last").text() + "</p>";
      $date.filter(":not(:last)").each(function () {
        str += '<a data-date="' + $(this).text() + '">○</a>';
      });
      $date.filter(":last").each(function () {
        str += '<a data-date="' + $(this).text() + '">●</a>';
      });
      if ($date.filter(":first").text() != "") {
        $(this).empty().html(str);
      }
      var chkDay = $date.filter(":last").text().split(" ");
      var chkDay2 = chkDay[0].split("-");
      if (chkDay2[0] == year && chkDay2[1] == month && chkDay2[2] == date) {
        $(this).parent().addClass("today");
      }
    });
  };

  pathApp.setNaviMenu = function () {
    var $naviMenu = pathApp.$body.find(".naviMenu");
    var html = "";

    html += "<ul>";
    html += "<li><a href='#' class='allMenu on'>전체보기</a></li>";
    pathApp.$dep1.each(function (idx) {
      var thatTit = $(this).find(".tit").text();
      $(this).attr("id", "menu" + idx);
      html +=
        "<li><a href='#' class='menu' data-key=" +
        idx +
        ">" +
        parseInt(idx + 1) +
        "." +
        thatTit +
        "<span class='countWrap'>(<em class='count'></em>/<em class='allCount'></em>) <em class='progress'></em></span></a></li>";
    });
    html += "</ul>";
    $naviMenu.html(html);
  };

  pathApp.initNaviMenuEvent = function () {
    pathApp.$allMenu = pathApp.$body.find(".allMenu");
    pathApp.$menu = pathApp.$body.find(".menu");
    pathApp.$allMenu.on("click", pathApp.handleAllMenuClick);
    pathApp.$menu.on("click", pathApp.handleNaviMenuClick);
  };

  pathApp.handleAllMenuClick = function () {
    pathApp.$pathTbl.find("tbody tr").show();
    $(".naviMenu li a").removeClass("on");
    $(this).addClass("on").sibling().removeClass("on");
  };

  pathApp.handleNaviMenuClick = function () {
    $(".naviMenu li a").removeClass("on");
    $(this).addClass("on");
    var key = parseInt($(this).attr("data-key"));
    var dep1Check = parseInt(pathApp.$dep1.eq(key).attr("rowspan"));
    if (!dep1Check) {
      dep1Check = 1;
    }
    var listKey = pathApp.$dep1.eq(key).parent("tr").index();

    pathApp.$pathTbl.find("tbody tr").hide();

    for (var i = 0; i < dep1Check; i++) {
      pathApp.$pathTbl
        .find("tbody tr")
        .eq(listKey + i)
        .show();
    }
  };

  pathApp.initLineEvent = function () {
    var $urlLink = pathApp.$body.find(".url a");
    var $date = pathApp.$body.find(".date a");
    var $hoverElem = $(".pathTbl tbody th, .pathTbl tbody td");

    $urlLink.click(function () {
      var $active = $(this).parent().parent().parent().children();
      $hoverElem.removeAttr("style");
      $active.css({ "background-color": "#F5F7FA" });
      $urlLink.removeAttr("style");
    });

    $hoverElem.hover(
      function () {
        $(this).parent().addClass("on");
      },
      function () {
        $(this).parent().removeClass("on");
      }
    );

    $date
      .on("mouseenter", function () {
        $(this).parent().find("p").text($(this).attr("data-date"));
      })
      .on("mouseleave", function () {
        $(this)
          .parent()
          .find("p")
          .text($(this).parent().find("a:last").attr("data-date"));
      });
  };

  pathApp.initTotalCount = function () {
    var $total = pathApp.$body.find(".total");
    var $guideUrl = pathApp.$body.find(".guide .url");
    var $url = pathApp.$body.find(".url");
    var $guideCheck = pathApp.$body.find(".guide .check span");
    var $check = pathApp.$body.find(".check span");

    $total.each(function () {
      var sum = 0;
      var sumG = 0;
      var sumMinus = 0;
      var sumMinusG = 0;
      var count = 0;
      var countG = 0;

      $url.each(function () {
        if ($(this).find("span").html() != "") sum++;
        else sumMinus++;
      });

      $guideUrl.each(function () {
        if ($(this).find("span").html() != "") sumG++;
        else sumMinusG++;
      });

      $check.each(function () {
        if ($(this).hasClass(".comp")) count++;
      });

      $guideCheck.each(function () {
        if ($(this).hasClass(".comp")) countG++;
      });

      count = sum - sumG + (sumMinus - sumMinusG) - (count - countG);
      sum = sum - sumG;
      str = "";
      str +=
        "<span>" +
        count +
        " / " +
        sum +
        " Pages" +
        "</span>" +
        "<em>" +
        " (" +
        parseInt((count / sum) * 100) +
        "%" +
        ")" +
        "</em>";
      $(this).html("<strong>Total : </strong><span> " + str + "</span>");
    });
  };

  pathApp.initSectionCount = function () {
    var $countWrap = pathApp.$body.find(".countWrap");
    var $count = $countWrap.find(".count");
    var $allCount = $countWrap.find(".allCount");
    var $progress = $countWrap.find(".progress");
    var setCount = 0;
    var setIndex = -1;
    $count.text(setCount);

    pathApp.$pathTbl.find("tbody tr").each(function (idx) {
      if ($(this).find(".icon-state").attr("class") == "icon-state comp")
        setCount++;
      // alert(setCount);
      if ($(this).find("th").hasClass("dep1")) {
        setIndex += 1;
        setCount = 0;
        if ($(this).find(".icon-state").attr("class") == "icon-state comp")
          setCount++;
      }

      $count.eq(setIndex).text(setCount);
    });

    pathApp.$dep1.each(function (idx) {
      var thatRowspan = $(this).attr("rowspan");
      if (thatRowspan === undefined) thatRowspan = 1;
      $allCount.eq(idx).text(thatRowspan);

      var countText = parseInt($count.eq(idx).text());
      var allCountText = parseInt($allCount.eq(idx).text());
      $progress
        .eq(idx)
        .text("진행율:" + parseInt((countText / allCountText) * 100) + "%");
    });
  };

  pathApp.initSyntaxHighlighter = function () {
    SyntaxHighlighter.all();
  };

  pathApp.initPath = function () {
    pathApp.setUrl();
    pathApp.setDate();
    pathApp.setNaviMenu();
    pathApp.initNaviMenuEvent();
    pathApp.initLineEvent();
    pathApp.initTotalCount();
    pathApp.initSectionCount();
    hasPathObject(pathApp.$body.find(".code")) && pathApp.initSyntaxHighlighter();
  };

  pathApp.tableRowSpan();

  $(function () {
    pathApp.$body = $("body");
    pathApp.$pathTbl = pathApp.$body.find(".pathTbl");
    pathApp.$dep1 = pathApp.$pathTbl.find(".dep1");
    pathApp.initPath();
  });
</script>

</html>